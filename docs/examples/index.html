<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · Juqbox.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Juqbox.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../workflow/">Workflow</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Risk-Neutral-Optimization"><span>Risk-Neutral Optimization</span></a></li></ul></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><a class="tocitem" href="../function-index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/LLNL/Juqbox.jl/blob/master/docs/src/examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>Examples of the setup procedure can be found in the scripts in the <code>Juqbox.jl/examples</code> directory. The examples are invoked by, e.g.</p><ul><li><code>include(&quot;cnot1-setup.jl&quot;)</code></li></ul><p>The following cases are included:</p><ul><li><code>rabi-setup.jl</code> Pi-pulse (X-gate) for a qubit, i.e. a Rabi oscillator.</li><li><code>cnot1-setup.jl</code> CNOT gate for a single qudit with 4 essential and 2 guard levels. </li><li><code>flux-setup.jl</code> CNOT gate for single qubit with a flux-tuning control Hamiltonian.</li><li><code>cnot2-setup.jl</code> CNOT gate for a pair of coupled qubits with guard levels.</li><li><code>cnot3-setup.jl</code> Cross-resonance CNOT gate for a pair of qubits that are coupled by a cavity resonator.</li></ul><p><strong>Note:</strong> The last case reads an optimized solution from file.</p><h2 id="Risk-Neutral-Optimization"><a class="docs-heading-anchor" href="#Risk-Neutral-Optimization">Risk-Neutral Optimization</a><a id="Risk-Neutral-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Risk-Neutral-Optimization" title="Permalink"></a></h2><p>In practice the entries of the Hamiltonian may have some uncertainty, especially for higher energy levels, and it is desirable to design control pulses that are more robust to noise.  For both of the following examples, we consider a risk-neutral strategy to design a <span>$|0\rangle \leftrightarrow |2\rangle$</span> SWAP gate on a single qubit, with three essential levels and one guard level. Let <span>$\epsilon$</span> be a random variable and consider the uncertain system Hamiltonian <span>$H^{u}_s(\epsilon) = H^{rw}_s + H&#39;(\epsilon)$</span> where <span>$H^{rw}_s$</span> is the system Hamiltonian in the rotating frame, and <span>$H&#39;(\epsilon)$</span> is the uncertain diagonal perturbation:</p><p class="math-container">\[    \frac{H&#39;(\epsilon)}{2\pi} = \begin{pmatrix}
      0 &amp;  &amp;  &amp;  \\
       &amp; \epsilon/100 &amp;  &amp;  \\
       &amp;  &amp; \epsilon/10 &amp;  \\
       &amp;  &amp;  &amp; \epsilon
    \end{pmatrix}.\]</p><p>We note that the uncertain system Hamiltonian has expectation <span>$\mathbb{E}[H^{u}_s(\epsilon)] = H^{rw}_s$</span>. We may correspondingly update the original objective function, <span>$\mathcal{G}(\bm{\alpha},H^{rw}_s)$</span>, to the risk-neutral utility function <span>$\widetilde{\mathcal{G}}(\bm{\alpha}) = \mathbb{E}[\mathcal{G}(\bm{\alpha}, H^u_s(\epsilon))]$</span>. For simple forms of the random variable <span>$\epsilon$</span>, we may compute <span>$\widetilde{\mathcal{G}}$</span> by quadrature:</p><p class="math-container">\[    \mathbb{E}[\mathcal{G}(\alpha,H^u_s (\epsilon))] 
    = \int_{-\epsilon_\text{max}}^{ \epsilon_\text{max}}
       \mathcal{G}(\alpha, H^u_s(\epsilon)) \, d\epsilon
       \approx
       \sum_{k = 1}^M w_k \mathcal{G}(\alpha, H^u_s(\epsilon_k) ),\]</p><p>where <span>$w_k$</span> and <span>$\epsilon_k$</span> are the weights and collocation points of a quadrature rule. </p><p>Examples of the setup procedure can be found in the scripts in the <code>Juqbox.jl/examples/Risk_Neutral</code> directory. The <code>run_all.jl</code> routine for both examples performs both a deterministic optimization, and a risk-neutral optimization where the system Hamiltonian is perturbed by additive noise. Full details of the first example can be found in Section 6.2 of the manuscript found <a href="https://arxiv.org/abs/2106.14310">here</a>.</p><h3 id="Example-1-:-Uniform-Noise"><a class="docs-heading-anchor" href="#Example-1-:-Uniform-Noise">Example 1 : Uniform Noise</a><a id="Example-1-:-Uniform-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1-:-Uniform-Noise" title="Permalink"></a></h3><p>For a first example, we let <span>$\epsilon \sim \text{Unif}(- \epsilon_\text{max}, \epsilon_\text{max})$</span> be a uniform random variable for some <span>$\epsilon_\text{max} &gt; 0$</span>. We may compute the risk-neutral objective function via a simple Gauss-Legendre quadrature. To do this, Juqbox calls the <code>FastGaussianQuadrature.jl</code> package to generate  appropriate nodes and weights via the call</p><pre><code class="language-julia hljs">nodes, weights = gausslegendre(nquad)</code></pre><p>for <code>nquad</code> quadrature points. We note, however, that the usual Gauss-Legendre quadrature integrates over the interval <span>$[-1,1]$</span>. A simple modification of the nodes and weights then creates a quadrature rule  in the interval <span>$(- \epsilon_\text{max}, \epsilon_\text{max})$</span>:</p><pre><code class="language-julia hljs"># Map nodes to [-ϵ/2,ϵ/2]
nodes .*= 0.5*ep_max
weights .*= 0.5</code></pre><p>Passing <code>nodes</code> and <code>weights</code> as keyword arguments to the <code>Juqbox.setup_ipopt_problem</code> routine then allows Juqbox to  perform a risk-neutral optimization:</p><pre><code class="language-julia hljs">prob = Juqbox.setup_ipopt_problem(params,..., nodes=nodes, weights=weights)</code></pre><h3 id="Example-2-:-Bimodal-Gaussian-Noise"><a class="docs-heading-anchor" href="#Example-2-:-Bimodal-Gaussian-Noise">Example 2 : Bimodal Gaussian Noise</a><a id="Example-2-:-Bimodal-Gaussian-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2-:-Bimodal-Gaussian-Noise" title="Permalink"></a></h3><p>From the previous example, we see that performing a risk-neutral optimization requires the user to provide an appropriate quadrature rule for a given noise model. If one is interested in considered models with normally-distributed (Gaussian) noise, we may instead use a Gauss-Hermite rule to generate quadrature for a risk-neutral optimization. For a bimodal Gaussian distribution, for instance, we may specify an array of means and standard deviations for each:</p><pre><code class="language-julia hljs">mean_vec = 2*pi.*[-1e-2 1e-2]
sig_vec = 2*pi*[1e-3, 1e-3]</code></pre><p>With the mean and standard deviation for each Gaussian mode defined, we may then generate a set of reference Gauss-Hermite quadrature weights and nodes (chosen specifically for the <span>$e^{-x^2}$</span> weight function):</p><pre><code class="language-julia hljs">nodes_tmp, weights_tmp = gausshermite(nquad)</code></pre><p>We note that this quadrature rule essentially integrates a function against a  Gaussian with a mean of zero and unit variance. The simple transformation below  obtains a rule for the above user-specified probability distribution:</p><pre><code class="language-julia hljs"># Make a larger node list for full distribution
n_modes = length(mean_vec)
nodes = zeros(n_modes*nquad)
weights = copy(nodes)
inv_n = 1.0/(n_modes*sqrt(pi))

# Mapping to reference weighting function
for i = 1:n_modes
    μ = mean_vec[i]
    σ = sig_vec[i]

	offset = (i-1)*nquad
	for j = 1:length(nodes_tmp)
		nodes[j + offset] = sqrt(2)*σ*nodes_tmp[j] + μ
        weights[j+offset] = weights_tmp[j]*inv_n
    end
end</code></pre><h3 id="Other-Noise-Models"><a class="docs-heading-anchor" href="#Other-Noise-Models">Other Noise Models</a><a id="Other-Noise-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Noise-Models" title="Permalink"></a></h3><p>We note that by modifying the <code>eval_f_par</code> and <code>eval_grad_f_par</code> routines in <code>src/ipopt_interface.jl</code> file  allows the use of other noise models for a risk-neutral optimization. Juqbox currently does not support  time-dependent noise processes.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../workflow/">« Workflow</a><a class="docs-footer-nextpage" href="../types/">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 15 September 2022 21:13">Thursday 15 September 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
